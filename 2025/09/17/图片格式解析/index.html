<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="Prometheus0017">
    
    <!-- Completely eliminate flash of wrong theme -->
    <script>
        (function() {
            const THEME_KEY = "REDEFINE-THEME-STATUS";
            const DARK = "dark", LIGHT = "light";
            
            // Get preferred theme
            function getTheme() {
                try {
                    const saved = localStorage.getItem(THEME_KEY);
                    if (saved) {
                        const { isDark } = JSON.parse(saved);
                        return isDark ? DARK : LIGHT;
                    }
                } catch (e) {}
                
                return matchMedia("(prefers-color-scheme: dark)").matches ? DARK : LIGHT;
            }
            
            // Apply theme to document
            function applyTheme(theme) {
                const isDark = theme === DARK;
                const root = document.documentElement;
                
                // Set data attribute for CSS variables
                root.setAttribute("data-theme", theme);
                
                // Set classes for compatibility
                root.classList.add(theme);
                root.classList.remove(isDark ? LIGHT : DARK);
                root.style.colorScheme = theme;
            }
            
            // Initial application
            const theme = getTheme();
            applyTheme(theme);
            
            // Listen for system preference changes
            matchMedia("(prefers-color-scheme: dark)").addEventListener("change", ({ matches }) => {
                // Only update if using system preference (no localStorage entry)
                if (!localStorage.getItem(THEME_KEY)) {
                    applyTheme(matches ? DARK : LIGHT);
                }
            });
            
            // Set body classes once DOM is ready
            if (document.readyState !== "loading") {
                document.body.classList.add(theme + "-mode");
            } else {
                document.addEventListener("DOMContentLoaded", () => {
                    document.body.classList.add(theme + "-mode");
                    document.body.classList.remove((theme === DARK ? LIGHT : DARK) + "-mode");
                });
            }
        })();
    </script>
    
    <!-- Critical CSS to prevent flash -->
    <style>
        :root[data-theme="dark"] {
            --background-color: #202124;
            --background-color-transparent: rgba(32, 33, 36, 0.6);
            --second-background-color: #2d2e32;
            --third-background-color: #34353a;
            --third-background-color-transparent: rgba(32, 33, 36, 0.6);
            --primary-color: #0066CC;
            --first-text-color: #ffffff;
            --second-text-color: #eeeeee;
            --third-text-color: #bebec6;
            --fourth-text-color: #999999;
            --default-text-color: #bebec6;
            --invert-text-color: #373D3F;
            --border-color: rgba(255, 255, 255, 0.08);
            --selection-color: #0066CC;
            --shadow-color-1: rgba(255, 255, 255, 0.08);
            --shadow-color-2: rgba(255, 255, 255, 0.05);
        }
        
        :root[data-theme="light"] {
            --background-color: #fff;
            --background-color-transparent: rgba(255, 255, 255, 0.6);
            --second-background-color: #f8f8f8;
            --third-background-color: #f2f2f2;
            --third-background-color-transparent: rgba(241, 241, 241, 0.6);
            --primary-color: #0066CC;
            --first-text-color: #16171a;
            --second-text-color: #2f3037;
            --third-text-color: #5e5e5e;
            --fourth-text-color: #eeeeee;
            --default-text-color: #373D3F;
            --invert-text-color: #bebec6;
            --border-color: rgba(0, 0, 0, 0.08);
            --selection-color: #0066CC;
            --shadow-color-1: rgba(0, 0, 0, 0.08);
            --shadow-color-2: rgba(0, 0, 0, 0.05);
        }
        
        body {
            background-color: var(--background-color);
            color: var(--default-text-color);
        }
        
        /* Apply body classes as soon as DOM is ready */
        :root[data-theme="dark"] body {
            background-color: var(--background-color);
            color: var(--default-text-color);
        }
    </style>
    
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://example.com/2025/09/17/图片格式解析/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
    
    
        
        <meta name="description" content="分享技术路上的所学所思，也拾掇些钟情角色的记忆碎片💖。一个不成体系的小破站 (〃∀〃)ゞ 希望能遇见兴趣相投的你~ ✨">
<meta property="og:type" content="article">
<meta property="og:title" content="手撕主流图像(PNG&#x2F;JPEG)：从理解文件数据结构到图像尺寸解析的实战">
<meta property="og:url" content="http://example.com/2025/09/17/%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E8%A7%A3%E6%9E%90/index.html">
<meta property="og:site_name" content="Seele">
<meta property="og:description" content="分享技术路上的所学所思，也拾掇些钟情角色的记忆碎片💖。一个不成体系的小破站 (〃∀〃)ゞ 希望能遇见兴趣相投的你~ ✨">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://pub-a1cb67b2f5c34421bbd8c98bcf68643b.r2.dev/assets/open_graph.png">
<meta property="article:published_time" content="2025-09-17T08:40:04.000Z">
<meta property="article:modified_time" content="2025-09-22T08:25:48.404Z">
<meta property="article:author" content="Prometheus17">
<meta property="article:tag" content="PNG">
<meta property="article:tag" content="JPEG">
<meta property="article:tag" content="image">
<meta property="article:tag" content="protocol">
<meta property="article:tag" content="learning">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pub-a1cb67b2f5c34421bbd8c98bcf68643b.r2.dev/assets/open_graph.png">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="https://pub-a1cb67b2f5c34421bbd8c98bcf68643b.r2.dev/assets/seele-cute-black-removebg.png" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="https://pub-a1cb67b2f5c34421bbd8c98bcf68643b.r2.dev/assets/seele-cute-black-removebg.png">
    <meta name="theme-color" content="#fe5d6d">
    <link rel="shortcut icon" href="https://pub-a1cb67b2f5c34421bbd8c98bcf68643b.r2.dev/assets/seele-cute-black-removebg.png">
    <!--- Page Info-->
    
    <title>
        
            手撕主流图像(PNG/JPEG)：从理解文件数据结构到图像尺寸解析的实战 | Null Pointer律者 😋
        
    </title>

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">


    <!--- Inject Part-->
    
        
            
    
            
    

    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/css/build/tailwind.css">

    

    
<link rel="stylesheet" href="/fonts/GeistMono/geist-mono.css">

    
<link rel="stylesheet" href="/fonts/Geist/geist.css">

    <!--- Font Part-->
    
    
    
        <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&display=swap" rel="stylesheet">
    
    
    
        <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&display=swap" rel="stylesheet">
    
    
        
<script src="/js/build/libs/anime.min.js"></script>

    

    <script id="hexo-configurations">
    window.config = {"hostname":"example.com","root":"/","language":"zh-CN","path":"search.json"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"delete_mask":true,"title_alignment":"left","headings_top_spacing":{"h1":"3.2rem","h2":"2.4rem","h3":"1.9rem","h4":"1.6rem","h5":"1.4rem","h6":"1.3rem"}},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":["Lv6"]},"code_block":{"copy":true,"style":"mac","highlight_theme":{"light":"github","dark":"atom-one-dark"},"font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":6,"number":false,"expand":true,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"pangu_js":true,"recommendation":{"enable":true,"title":"推荐阅读","limit":3,"mobile_limit":2,"placeholder":"https://pub-a1cb67b2f5c34421bbd8c98bcf68643b.r2.dev/assets/open_graph.png","skip_dirs":["/docs/","/private/"]}},"colors":{"primary":"#fe5d6d","secondary":null,"default_mode":"light"},"global":{"fonts":{"chinese":{"enable":true,"family":"'Ma Shan Zheng', cursive","url":"https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&display=swap"},"english":{"enable":false,"family":null,"url":null},"title":{"enable":true,"family":"'Ma Shan Zheng', cursive","url":"https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&display=swap"}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":true},"scroll_progress":{"bar":false,"percentage":true},"website_counter":{"url":"https://cn.vercount.one/js","enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":{"enable":true,"custom_message":"少女祈祷中... (◕ᴗ◕✿)"},"side_tools":{"gear_rotation":true,"auto_expand":false},"open_graph":{"enable":true,"image":"https://pub-a1cb67b2f5c34421bbd8c98bcf68643b.r2.dev/assets/open_graph.png","description":"分享技术路上的所学所思，也拾掇些钟情角色的记忆碎片💖。一个不成体系的小破站 (〃∀〃)ゞ 希望能遇见兴趣相投的你~ ✨"},"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"https://pub-a1cb67b2f5c34421bbd8c98bcf68643b.r2.dev/assets/夏日生存狂想曲17.png","dark":"https://pub-a1cb67b2f5c34421bbd8c98bcf68643b.r2.dev/assets/sparkle.jpg"},"title":"17号的航行日志","subtitle":{"text":["当你为错过太阳而哭泣的时候，你也要再错过群星了","有一个夜晚我烧毁了所有的记忆，从此我的梦就透明了","有一个早晨我扔掉了所有的昨天，从此我的脚步就轻盈了","我无法选择命运，但我可以选择成为什么样的人","世界是不美好，所以美好才是人们心中的渴望","是大家的心意，让我成为了现在的我","当一个故事要结束的时候，我们总会想起它的开始，就像是一切回到了从前","生命是昂贵又脆弱的东西。一个人能活着，是因为许多无辜的生命为他献上了牺牲","故事总有结束的时候，但留下的记忆不会消失，传递的感情不会消失。它们会成为后来者的钥匙，被人铭记......延伸向未来，永远存在","那些带领我、指引我的人，我会循着他们的足迹前进，以此铭记，他们存在过","永远不要期待在雪地里能走回头路，风雪会将你的脚印全部掩埋，你只能向前","在身处黑暗时，人总会想抓住点什么吧","每个人都是一面镜子，倒映出在他眼中的样子","我们不需要救世主，我们自己来拯救自己","铭记过去，是为了开拓更好的未来","有时候，如果过于在意一件事，它反而会让人忘记初心，甚至变成阻碍我们前进的魔咒","如果因为害怕玫瑰上的刺而否定玫瑰本身，进而远离花园，那会是多么遗憾的一件事啊","我想……每个人的回忆，都值得被守护","相信你愿意相信的，坚持你愿意坚持的，这不就够了吗？","所谓童话就是总有一天会结束的故事","不知何时起，我已不再畏惧黑暗，因为我知道，有一束光，永远在那里","我从不相信什么命运，未来由我自己来决定","即使未来不能改变，我也要自己决定到达那个结果的过程。重要的是在这段旅途中，我想要相信什么。那会决定在抵达终点时，我能够得到什么。而结局，也会因此展现截然不同的意义","一个人的性格，就是他的命运","任何人都有机会看清世界的本貌，并且承担它的重量——这就是我们所说的牺牲","赫克托尔知道王国终将陷落，阿喀琉斯也明白自己正在走向死亡。但他们两人，依然义无反顾地踏上了战场，在这个从一开始就注定是悲剧的故事里，没有一个人曾为此犹豫或者动摇，他们如此，我们，亦是如此","他们并非坚韧过于常人，只是知晓失败是胜利的另一种名字","鸟为什么会飞？因为它们必须飞向天际","当终焉的陨星在白垩纪降下，唯有自由的鸟儿才能跳出既定的灭亡","真理属于人类，谬误属于时代","执拗的花朵永远不会因暴雨而褪去颜色，你的决心也一定能在绝境中绽放真我","愿你前行的道路有群星闪耀。愿你留下的足迹有百花绽放。你即是上帝的馈赠，世界因你而瑰丽","悲剧并非终结，而是希望的起始。只有人类会这样想，也只有人类会将这样的信念化为现实","告别过去，是为了走向未来","要流传给后世的，绝不应该只有憎恨和使命。只有领略过这个时代的光辉和灿烂，未来的人们才能理解我们为之而战的意义","不是被推搡，被裹挟着向前，也不是沿着被别人选定的道路行进。而是怀着这样的想法——我想要怎么做，我应该怎么做——去决定自己的命路，自己的刻印","以自我的意志，朝着自身所设下的目标，用自在的方式，竭尽全力活过“我”作为主角的一生","悲伤不会凭空消失，但温暖的感情也会永远在心底珍藏","我们在世间留下的足迹，终会在未来的某一日，成为另一个人前行的灯火","想验证一个人的真心，首先得要相信，不是吗?","人性的美丽……就是如此闪耀，却易碎的事物呀。但正因为易碎，所以才要用心去保护，对不对?","我们会留在过去，而你将走向未来。然后，就去绽放出独属于你的，无瑕而美丽的光辉吧!"],"hitokoto":{"enable":false,"show_author":false,"api":"https://v1.hitokoto.cn"},"typing_speed":80,"backing_speed":25,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":false},"text_color":{"light":"#ffffff","dark":"#ff0000"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":true,"style":"default","links":{"github":"https://github.com/ElysiaFollower","instagram":null,"zhihu":null,"twitter":null,"email":"prometheus0017@qq.com"},"qrs":null}},"plugins":{"feed":{"enable":true},"aplayer":{"enable":true,"type":"fixed","audios":[{"name":"光へ (向着光)","artist":"フランシュシュ","url":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E5%85%89%E3%81%B8/光へ.mp3","cover":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E5%85%89%E3%81%B8/光へ.jpg","lrc":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E5%85%89%E3%81%B8/光へ.lrc"},{"name":"輝いて","artist":"フランシュシュ","url":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E8%BC%9D%E3%81%84%E3%81%A6/輝いて.mp3","cover":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E8%BC%9D%E3%81%84%E3%81%A6/輝いて.jpg","lrc":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E8%BC%9D%E3%81%84%E3%81%A6/輝いて.lrc"},{"name":"Dye the sky.","artist":"シャイニーカラーズ","url":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/Dye%20the%20sky./Dye the sky..mp3","cover":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/Dye%20the%20sky./Dye the sky..jpg","lrc":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/Dye%20the%20sky./Dye the sky..lrc"},{"name":"限りなく灰色へ (feat. 宵崎奏&朝比奈まふゆ&東雲絵名&暁山瑞希&鏡音リン)","artist":"すりぃ, 25時、ナイトコードで。, 鏡音リン","url":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E9%99%90%E3%82%8A%E3%81%AA%E3%81%8F%E7%81%B0%E8%89%B2%E3%81%B8%20%28feat.%20%E5%AE%B5%E5%B4%8E%E5%A5%8F%26%E6%9C%9D%E6%AF%94%E5%A5%88%E3%81%BE%E3%81%B5%E3%82%86%26%E6%9D%B1%E9%9B%B2%E7%B5%B5%E5%90%8D%26%E6%9A%81%E5%B1%B1%E7%91%9E%E5%B8%8C%26%E9%8F%A1%E9%9F%B3%E3%83%AA%E3%83%B3%29/限りなく灰色へ (feat. 宵崎奏&朝比奈まふゆ&東雲絵名&暁山瑞希&鏡音リン).mp3","cover":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E9%99%90%E3%82%8A%E3%81%AA%E3%81%8F%E7%81%B0%E8%89%B2%E3%81%B8%20%28feat.%20%E5%AE%B5%E5%B4%8E%E5%A5%8F%26%E6%9C%9D%E6%AF%94%E5%A5%88%E3%81%BE%E3%81%B5%E3%82%86%26%E6%9D%B1%E9%9B%B2%E7%B5%B5%E5%90%8D%26%E6%9A%81%E5%B1%B1%E7%91%9E%E5%B8%8C%26%E9%8F%A1%E9%9F%B3%E3%83%AA%E3%83%B3%29/限りなく灰色へ (feat. 宵崎奏&朝比奈まふゆ&東雲絵名&暁山瑞希&鏡音リン).jpg","lrc":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E9%99%90%E3%82%8A%E3%81%AA%E3%81%8F%E7%81%B0%E8%89%B2%E3%81%B8%20%28feat.%20%E5%AE%B5%E5%B4%8E%E5%A5%8F%26%E6%9C%9D%E6%AF%94%E5%A5%88%E3%81%BE%E3%81%B5%E3%82%86%26%E6%9D%B1%E9%9B%B2%E7%B5%B5%E5%90%8D%26%E6%9A%81%E5%B1%B1%E7%91%9E%E5%B8%8C%26%E9%8F%A1%E9%9F%B3%E3%83%AA%E3%83%B3%29/限りなく灰色へ (feat. 宵崎奏&朝比奈まふゆ&東雲絵名&暁山瑞希&鏡音リン).lrc"},{"name":"アンチユー (Anti You)","artist":"MORE MORE JUMP!","url":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E3%82%A2%E3%83%B3%E3%83%81%E3%83%A6%E3%83%BC/アンチユー.mp3","cover":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E3%82%A2%E3%83%B3%E3%83%81%E3%83%A6%E3%83%BC/アンチユー.jpg","lrc":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E3%82%A2%E3%83%B3%E3%83%81%E3%83%A6%E3%83%BC/アンチユー.lrc"},{"name":"白昼梦","artist":"こぴ","url":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E7%99%BD%E6%98%BC%E6%A2%A6/白昼梦.mp3","cover":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E7%99%BD%E6%98%BC%E6%A2%A6/白昼梦.jpg","lrc":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E7%99%BD%E6%98%BC%E6%A2%A6/白昼梦.lrc"},{"name":"罪の天使","artist":"TetraCalyx","url":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E7%BD%AA%E3%81%AE%E5%A4%A9%E4%BD%BF/罪の天使.mp3","cover":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E7%BD%AA%E3%81%AE%E5%A4%A9%E4%BD%BF/罪の天使.jpg","lrc":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E7%BD%AA%E3%81%AE%E5%A4%A9%E4%BD%BF/罪の天使.lrc"},{"name":"Da Capo","artist":"HOYO-MiX","url":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/Da%20Capo/Da Capo.mp3","cover":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/Da%20Capo/Da Capo.jpg","lrc":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/Da%20Capo/Da Capo.lrc"},{"name":"Moon Halo","artist":"茶理理, TetraCalyx, Hanser, HOYO-MiX","url":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/Moon%20Halo/Moon Halo.mp3","cover":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/Moon%20Halo/Moon Halo.jpg","lrc":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/Moon%20Halo/Moon Halo.lrc"},{"name":"TruE","artist":"黄龄, HOYO-MiX","url":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/TruE/TruE.mp3","cover":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/TruE/TruE.jpg","lrc":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/TruE/TruE.lrc"},{"name":"崩坏世界的歌姬 (Movie Ver.)","artist":"小林未郁","url":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E5%B4%A9%E5%9D%8F%E4%B8%96%E7%95%8C%E7%9A%84%E6%AD%8C%E5%A7%AC%20%28Movie%20Ver.%29/崩坏世界的歌姬 (Movie Ver.).mp3","cover":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E5%B4%A9%E5%9D%8F%E4%B8%96%E7%95%8C%E7%9A%84%E6%AD%8C%E5%A7%AC%20%28Movie%20Ver.%29/崩坏世界的歌姬 (Movie Ver.).jpg","lrc":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E5%B4%A9%E5%9D%8F%E4%B8%96%E7%95%8C%E7%9A%84%E6%AD%8C%E5%A7%AC%20%28Movie%20Ver.%29/崩坏世界的歌姬 (Movie Ver.).lrc"},{"name":"Starfall","artist":"袁娅维TIA RAY","url":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/Starfall/Starfall.mp3","cover":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/Starfall/Starfall.jpg","lrc":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/Starfall/Starfall.lrc"},{"name":"Cyberangel","artist":"Hanser","url":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/Cyberangel/Cyberangel.mp3","cover":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/Cyberangel/Cyberangel.jpg","lrc":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/Cyberangel/Cyberangel.lrc"},{"name":"ノット・グッド・ワールド","artist":"あやぽんず*, あよ","url":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E3%83%8E%E3%83%83%E3%83%88%E3%83%BB%E3%82%B0%E3%83%83%E3%83%89%E3%83%BB%E3%83%AF%E3%83%BC%E3%83%AB%E3%83%89/ノット・グッド・ワールド.mp3","cover":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E3%83%8E%E3%83%83%E3%83%88%E3%83%BB%E3%82%B0%E3%83%83%E3%83%89%E3%83%BB%E3%83%AF%E3%83%BC%E3%83%AB%E3%83%89/ノット・グッド・ワールド.jpg","lrc":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E3%83%8E%E3%83%83%E3%83%88%E3%83%BB%E3%82%B0%E3%83%83%E3%83%89%E3%83%BB%E3%83%AF%E3%83%BC%E3%83%AB%E3%83%89/ノット・グッド・ワールド.lrc"},{"name":"星になる (feat. 倚水)","artist":"Islet, 倚水","url":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E6%98%9F%E3%81%AB%E3%81%AA%E3%82%8B%20%28feat.%20%E5%80%9A%E6%B0%B4%29/星になる (feat. 倚水).mp3","cover":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E6%98%9F%E3%81%AB%E3%81%AA%E3%82%8B%20%28feat.%20%E5%80%9A%E6%B0%B4%29/星になる (feat. 倚水).jpg","lrc":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E6%98%9F%E3%81%AB%E3%81%AA%E3%82%8B%20%28feat.%20%E5%80%9A%E6%B0%B4%29/星になる (feat. 倚水).lrc"},{"name":"REVENGE","artist":"フランシュシュ","url":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/REVENGE/REVENGE.mp3","cover":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/REVENGE/REVENGE.jpg","lrc":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/REVENGE/REVENGE.lrc"},{"name":"拂晓 Proi Proi","artist":"HOYO-MiX, NIDA","url":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/拂晓 Proi Proi/拂晓 Proi Proi.mp3","cover":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/拂晓 Proi Proi/拂晓 Proi Proi.jpg","lrc":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/拂晓 Proi Proi/拂晓 Proi Proi.lrc"},{"name":"何者","artist":"谭晶, HOYO-MiX","url":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E4%BD%95%E8%80%85/何者.mp3","cover":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E4%BD%95%E8%80%85/何者.jpg","lrc":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E4%BD%95%E8%80%85/何者.lrc"},{"name":"アンノウン・マザーグース","artist":"wowaka, 初音ミク","url":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/wowaka%2C%20%E5%88%9D%E9%9F%B3%E3%83%9F%E3%82%AF/wowaka, 初音ミク.mp3","cover":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/wowaka%2C%20%E5%88%9D%E9%9F%B3%E3%83%9F%E3%82%AF/wowaka, 初音ミク.jpg","lrc":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/wowaka%2C%20%E5%88%9D%E9%9F%B3%E3%83%9F%E3%82%AF/wowaka, 初音ミク.lrc"},{"name":"[囧菌] シニカルナイトプラン（翻自 初音ミク）","artist":"封茗囧菌","url":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%5B%E5%9B%A7%E8%8F%8C%5D%20%E3%82%B7%E3%83%8B%E3%82%AB%E3%83%AB%E3%83%8A%E3%82%A4%E3%83%88%E3%83%97%E3%83%A9%E3%83%B3/[囧菌] シニカルナイトプラン.mp3","cover":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%5B%E5%9B%A7%E8%8F%8C%5D%20%E3%82%B7%E3%83%8B%E3%82%AB%E3%83%AB%E3%83%8A%E3%82%A4%E3%83%88%E3%83%97%E3%83%A9%E3%83%B3/[囧菌] シニカルナイトプラン.jpg","lrc":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%5B%E5%9B%A7%E8%8F%8C%5D%20%E3%82%B7%E3%83%8B%E3%82%AB%E3%83%AB%E3%83%8A%E3%82%A4%E3%83%88%E3%83%97%E3%83%A9%E3%83%B3/[囧菌] シニカルナイトプラン.lrc"},{"name":"ツバサ (羽翼)","artist":"若山詩音","url":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E3%83%84%E3%83%90%E3%82%B5/ツバサ.mp3","cover":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E3%83%84%E3%83%90%E3%82%B5/ツバサ.jpg","lrc":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E3%83%84%E3%83%90%E3%82%B5/ツバサ.lrc"},{"name":"spiral","artist":"LONGMAN","url":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/spiral/spiral.mp3","cover":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/spiral/spiral.jpg","lrc":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/spiral/spiral.lrc"},{"name":"Believe in you","artist":"nonoc","url":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/Believe%20in%20you/Believe in you.mp3","cover":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/Believe%20in%20you/Believe in you.jpg","lrc":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/Believe%20in%20you/Believe in you.lrc"},{"name":"STYX HELIX","artist":"MYTH & ROID","url":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/STYX%20HELIX/STYX HELIX.mp3","cover":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/STYX%20HELIX/STYX HELIX.jpg","lrc":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/STYX%20HELIX/STYX HELIX.lrc"},{"name":"忘れてやらない","artist":"結束バンド","url":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E5%BF%98%E3%82%8C%E3%81%A6%E3%82%84%E3%82%89%E3%81%AA%E3%81%84/忘れてやらない.mp3","cover":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E5%BF%98%E3%82%8C%E3%81%A6%E3%82%84%E3%82%89%E3%81%AA%E3%81%84/忘れてやらない.jpg","lrc":"https://pub-afcc413539f94c73959ec3d27d32e67d.r2.dev/%E5%BF%98%E3%82%8C%E3%81%A6%E3%82%84%E3%82%89%E3%81%AA%E3%81%84/忘れてやらない.lrc"}]},"mermaid":{"enable":true,"version":"11.4.1"}},"version":"2.8.5","navbar":{"auto_hide":true,"color":{"left":"#f78736","right":"#367df7","transparency":35},"width":{"home":"1200px","pages":"1000px"},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Categories":{"path":"/categories","icon":"fa-regular fa-folder"},"Tags":{"path":"/tags","icon":"fa-regular fa-tags"},"相册":{"path":"/masonry","icon":"fa-regular fa-image"},"Friends":{"path":"/links","icon":"fa-regular fa-link"}},"search":{"enable":true,"preload":true}},"page_templates":{"friends_column":3,"tags_style":"cloud"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"info","announcement":"技术力有限，如果文章中存在错误或不足之处，欢迎联系讨论~🫡<br><br>\n","show_on_mobile":true,"links":{"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Tags":{"path":"/tags","icon":"fa-regular fa-tags"},"Categories":{"path":"/categories","icon":"fa-regular fa-folder"}}},"article_date_format":"auto","excerpt_length":200,"categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}},"footerStart":"2025/5/7 23:03:00"};
    window.lang_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"};
    window.data = {"masonry":true};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 7.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style><link rel="alternate" href="/atom.xml" title="Seele" type="application/atom+xml">
</head>



<body>
	<div class="progress-bar-container">
	

	
	<span class="pjax-progress-bar"></span>
	<!--        <span class="swup-progress-icon">-->
	<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
	<!--        </span>-->
	
</div>

<style>
    :root {
        --preloader-background-color: #fff;
        --preloader-text-color: #000;
    }

    @media (prefers-color-scheme: dark) {
        :root {
            --preloader-background-color: #202124;
            --preloader-text-color: #fff;
        }
    }

    @media (prefers-color-scheme: light) {
        :root {
            --preloader-background-color: #fff;
            --preloader-text-color: #000;
        }
    }

    @media (max-width: 600px) {
        .ml13 {
            font-size: 2.6rem !important; /* Adjust this value as needed */
        }
    }

    .preloader {
        display: flex;
        flex-direction: column;
        gap: 1rem; /* Tailwind 'gap-4' is 1rem */
        align-items: center;
        justify-content: center;
        position: fixed;
        padding: 12px;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        width: 100vw;
        height: 100vh; /* 'h-screen' is 100% of the viewport height */
        background-color: var(--preloader-background-color);
        z-index: 1100; /* 'z-[1100]' sets the z-index */
        transition: opacity 0.2s ease-in-out;
    }

    .ml13 {
        font-size: 3.2rem;
        /* text-transform: uppercase; */
        color: var(--preloader-text-color);
        letter-spacing: -1px;
        font-weight: 500;
        font-family: 'Chillax-Variable', sans-serif;
        text-align: center;
    }

    .ml13 .word {
        display: inline-flex;
        flex-wrap: wrap;
        white-space: nowrap;
    }

    .ml13 .letter {
        display: inline-block;
        line-height: 1em;
    }
</style>

<div class="preloader">
    <h2 class="ml13">
        少女祈祷中... (◕ᴗ◕✿)
    </h2>
    <script>
        var textWrapper = document.querySelector('.ml13');
        // Split text into words
        var words = textWrapper.textContent.trim().split(' ');

        // Clear the existing content
        textWrapper.innerHTML = '';

        // Wrap each word and its letters in spans
        words.forEach(function(word) {
            var wordSpan = document.createElement('span');
            wordSpan.classList.add('word');
            wordSpan.innerHTML = word.replace(/\S/g, "<span class='letter'>$&</span>");
            textWrapper.appendChild(wordSpan);
            textWrapper.appendChild(document.createTextNode(' ')); // Add space between words
        });

        var animation = anime.timeline({ loop: true })
            .add({
                targets: '.ml13 .letter',
                translateY: [20, 0],
                translateZ: 0,
                opacity: [0, 1],
                filter: ['blur(5px)', 'blur(0px)'],
                easing: "easeOutExpo",
                duration: 1200,
                delay: (el, i) => 300 + 20 * i,
            })
            .add({
                targets: '.ml13 .letter',
                translateY: [0, -20],
                opacity: [1, 0],
                filter: ['blur(0px)', 'blur(5px)'],
                easing: "easeInExpo",
                duration: 1000,
                delay: (el, i) => 15 * i,
                complete: function() {
                    hidePreloader();
                }
            }, '-=700');


        let themeStatus = JSON.parse(localStorage.getItem('REDEFINE-THEME-STATUS'))?.isDark;

        // If the theme status is not found in local storage, check the preferred color scheme
        if (themeStatus === undefined || themeStatus === null) {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                themeStatus = 'dark';
            } else {
                themeStatus = 'light';
            }
        }

        // Now you can use the themeStatus variable in your code
        if (themeStatus) {
            document.documentElement.style.setProperty('--preloader-background-color', '#202124');
            document.documentElement.style.setProperty('--preloader-text-color', '#fff');
        } else {
            document.documentElement.style.setProperty('--preloader-background-color', '#fff');
            document.documentElement.style.setProperty('--preloader-text-color', '#000');
        }

        window.addEventListener('load', function () {
            setTimeout(hidePreloader, 5000); // Call hidePreloader after 5000 milliseconds if not already called by animation
        });

        function hidePreloader() {
            var preloader = document.querySelector('.preloader');
            preloader.style.opacity = '0';
            setTimeout(function () {
                preloader.style.display = 'none';
            }, 200);
        }
    </script>
</div>

<main class="page-container" id="swup">

	

	<div class="main-content-container flex flex-col justify-between min-h-dvh">
		<div class="main-content-header">
			<header class="navbar-container px-6 md:px-12">
    <div class="navbar-content transition-navbar ">
        <div class="left">
            
                <a class="logo-image h-8 w-8 sm:w-10 sm:h-10 mr-3" href="/">
                    <img src="https://pub-a1cb67b2f5c34421bbd8c98bcf68643b.r2.dev/assets/Griseo.png" class="w-full h-full rounded-xs">
                </a>
            
            <a class="logo-title" href="/">
                
                Null Pointer律者 😋
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    首页
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/archives"
                                        >
                                    <i class="fa-regular fa-archive fa-fw"></i>
                                    归档
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/categories"
                                        >
                                    <i class="fa-regular fa-folder fa-fw"></i>
                                    分类
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/tags"
                                        >
                                    <i class="fa-regular fa-tags fa-fw"></i>
                                    标签
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/masonry"
                                        >
                                    <i class="fa-regular fa-image fa-fw"></i>
                                    相册
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/links"
                                        >
                                    <i class="fa-regular fa-link fa-fw"></i>
                                    友情链接
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i>
                    </div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                首页
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/archives"
                        >
                            <span>
                                归档
                            </span>
                            
                                <i class="fa-regular fa-archive fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/categories"
                        >
                            <span>
                                分类
                            </span>
                            
                                <i class="fa-regular fa-folder fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/tags"
                        >
                            <span>
                                标签
                            </span>
                            
                                <i class="fa-regular fa-tags fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/masonry"
                        >
                            <span>
                                相册
                            </span>
                            
                                <i class="fa-regular fa-image fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/links"
                        >
                            <span>
                                友情链接
                            </span>
                            
                                <i class="fa-regular fa-link fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            

            
            
                
                    
                    
                    
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">28</div>
        <div class="label text-third-text-color text-sm">标签</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">12</div>
        <div class="label text-third-text-color text-sm">分类</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">8</div>
        <div class="label text-third-text-color text-sm">文章</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


		</div>

		<div class="main-content-body transition-fade-up">
			

			<div class="main-content">
				<div class="post-page-container flex relative justify-between box-border w-full h-full">
	<div class="article-content-container">

		<div class="article-title relative w-full">
			
			
			
			<img src="https://pub-a1cb67b2f5c34421bbd8c98bcf68643b.r2.dev/gallery/2025/09/17/miku2.png" alt="手撕主流图像(PNG/JPEG)：从理解文件数据结构到图像尺寸解析的实战" class="w-full h-60 sm:h-72 md:h-80 object-cover sm:rounded-t-large dark:brightness-75" />
			
			<div class="w-full flex items-center absolute bottom-0 justify-start">
				<h1 class="article-title-cover text-center mx-6 my-6 text-second-text-color bg-background-color-transparent px-4 py-3 text-3xl sm:text-4xl md:text-5xl font-semibold backdrop-blur-lg rounded-xl border border-border-color ">手撕主流图像(PNG/JPEG)：从理解文件数据结构到图像尺寸解析的实战</h1>
			</div>
			
		</div>

		
		<div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
			<div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
				<img src="https://pub-a1cb67b2f5c34421bbd8c98bcf68643b.r2.dev/assets/seele-cute-white-removebg.png">
			</div>
			<div class="info flex flex-col justify-between">
				<div class="author flex items-center">
					<span class="name text-default-text-color text-lg font-semibold">Prometheus0017</span>
					
					<span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv6</span>
					
				</div>
				<div class="meta-info">
					<div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2025-09-17 16:40:04</span>
        <span class="mobile">2025-09-17 16:40:04</span>
        <span class="hover-info">创建</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2025-09-22 16:25:48</span>
            <span class="mobile">2025-09-22 16:25:48</span>
            <span class="hover-info">更新</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/Image/">Image</a>&nbsp;
                        </li>
                    
                    
                
                    
                        
                            <li>></li>
                        
                        <li>
                            <a href="/categories/Image/protocol/">protocol</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/PNG/">PNG</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/JPEG/">JPEG</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/image/">image</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/protocol/">protocol</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/learning/">learning</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fa-regular fa-typewriter"></i>&nbsp;<span>4.9k 字</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fa-regular fa-clock"></i>&nbsp;<span>19 分钟</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

				</div>
			</div>
		</div>
		

		


		<div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
			<p>本文将从底层开始剖析当前主流图像格式的文件格式，但并不对其中压缩算法展开深入的研究。故而在下更愿意称本文探讨的重心为——图像的数据结构，即不同类型的数据在存储设备中如何排布。同时我们作为一个用户，如何能从图像中准确的取出我们所需要的某一部分数据 —— 一张图像文件除了图像本体，还留存有许多元信息。</p>
<p>本文将对几种常见图片格式建立基本的认知模型，同时以 <em>从图像数据流中提取出图像的分辨率，即宽高属性</em> 作为实战案例。</p>
<h2 id="PNG"><a href="#PNG" class="headerlink" title="PNG"></a>PNG</h2><p>参考2025年6月25日发布的第三版PNG规范<sup id="fnref:1_0"><a href="javascript:void(0);" rel="footnote" onclick="footnote_rememberSource('1', '1_0'); footnote_jumpToAnchor('fn:1')">[1]</a></sup></p>
<ul>
<li>关于PNG存储格式，主要参考官方说明的第五节<a class="link" target="_blank" rel="noopener" href="https://www.w3.org/TR/png-3/#5DataRep">Datastream structure<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></li>
</ul>
<p>PNG图像的格式其实相对来说非常的清晰易懂。它由**文件署名(PNG signature)<strong>和</strong>数据块(chunks)**两种类型的结构组成，而且从宏观上看，它就是 —— <strong>一个署名后面跟着很多个数据块</strong>。不同类型的数据块存储不同的数据。</p>
<h3 id="文件署名域-PNG-signature"><a href="#文件署名域-PNG-signature" class="headerlink" title="文件署名域(PNG signature)"></a>文件署名域(PNG signature)</h3><p><strong>署名用于确认一个文件是否是PNG文件</strong>，是永远出现在PNG数据流最头部的八字节常量。</p>
<p>用16进制打开任意PNG文件, 会发现前八个字节总是这几个十六进制数 <code>89 50 4E 47 0D 0A 1A 0A</code> </p>
<p>这八个字节就是PNG的文件署名。出现这个签名则表明剩下的内容包含<strong>单个PNG图像</strong>，该图像由一系列<strong>以’IHDR’开头、以’IEND’的数据块组成</strong>。</p>
<ul>
<li><p>为什么是“单张PNG图像”呢？实际上能播放动画的APNG也是这个署名开头：</p>
<ul>
<li><p>因为从技术上讲，<strong>APNG也属于’a single PNG image’</strong>。在下认为这并不只是一个无趣的文字游戏，因为APNG诞生在PNG之后，为了实现向下兼容，<strong>它只是在原基础上增添了几种新的数据块类型</strong>，如果忽略新增的数据块类型，那么剩下来的部分，就是<strong>像存储正常的PNG一样存储APNG的第一帧</strong>，所以即便是不支持APNG的老旧浏览器，只要对无法解析的数据块类型进行抛弃，就能够回退到“显示第一帧”的状态。<sup id="fnref:4_0"><a href="javascript:void(0);" rel="footnote" onclick="footnote_rememberSource('4', '4_0'); footnote_jumpToAnchor('fn:4')">[4]</a></sup><br>在理解了静态PNG格式之后再来看下面这张图，就能很容易理解APNG到底是怎么对原有的PNG进行拓展的了。</p>
<p><img lazyload="" src="/images/loading.svg" data-src="/2025/09/17/%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E8%A7%A3%E6%9E%90/720px-Apng_assembling.svg.png" alt="img"></p>
<p>这里从Wikipedia上借来一张APNG示例图，感兴趣可以用十六进制工具看看。在下的观察结果是完美符合上图的：<img lazyload="" src="/images/loading.svg" data-src="/2025/09/17/%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E8%A7%A3%E6%9E%90/Animated_PNG_example_bouncing_beach_ball.png" alt="Animated_PNG_example_bouncing_beach_ball"></p>
</li>
</ul>
</li>
</ul>
<p>这里使用VScode的Hex Editer插件，对一张普通的静态的PNG照片的十六进制数据进行观察：</p>
<ul>
<li><img lazyload="" src="/images/loading.svg" data-src="/2025/09/17/%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E8%A7%A3%E6%9E%90/PixPin_2025-09-17_16-49-30.png" alt="PixPin_2025-09-17_16-49-30"></li>
</ul>
<p><img lazyload="" src="/images/loading.svg" data-src="/2025/09/17/%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E8%A7%A3%E6%9E%90/PixPin_2025-09-17_17-10-12.png" alt="文件署名域"></p>
<p>如图所示，文件署名域对应一张PNG图像的前八个字节，可以发现里面还偷藏了一个”PNG”。理论符合预期，当我们要处理图像时，若解析到前八个字节为PNG的署名，那么就可以认为，我们将要解析一张PNG图像了。</p>
<h3 id="数据块"><a href="#数据块" class="headerlink" title="数据块"></a>数据块</h3><p>在署名之后，剩下的就都是一连串的数据块了。单个数据块的结构如下：<br><img lazyload="" src="/images/loading.svg" data-src="/2025/09/17/%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E8%A7%A3%E6%9E%90/PixPin_2025-09-17_22-06-54.png" alt="PixPin_2025-09-17_22-06-54"></p>
<p>其实非常简单，只需要建立 <strong>四个Field</strong> 的认知模型即可，每个Field分别代表(按顺序排布)</p>
<ul>
<li><p>length: <strong>四字节</strong>无符号整数，用于指定 实际数据CHUNK DATA 的长度 —— 所以长度为0的时候CHUNK DATA域等效于不存在，就回退到了图中所示的三个Field的情况了。</p>
</li>
<li><p>chunk type: <strong>四字节</strong>，每个字节可以理解为一个ASCII码</p>
<blockquote>
<p><em>Each byte of a chunk type is restricted to the hexadecimal values 41 to 5A and 61 to 7A</em></p>
</blockquote>
<p>​    熟悉的话其实会发现，这其实就是约束了每个字节对应的ASCII字符就是’A’-‘Z’ 或 ‘a’-‘z’, 也就是说是直接人类可读的英文字母编码</p>
</li>
<li><p>chunk data：实际的数据内容。<strong>长度由length域约束</strong>，可为0</p>
</li>
<li><p>CRC： <strong>四字节</strong>， 仅根据CHUNK TYPE和CHUNK DATA计算出来的值，属于<strong>校验码</strong>，这里不用太在意其中细节。</p>
</li>
</ul>
<p>至此，数据块基本结构的理解就已经完成了。整个PNG存储的模型也就出来了。再之后就只需要在用得到的时候补全对于<strong>不同类型数据块结构</strong>的认知即可。</p>
<p><strong>就是说，接下来去翻官网的<a class="link" target="_blank" rel="noopener" href="https://www.w3.org/TR/png-3/#11Chunks">#11. Chunk specifications<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a> 就可以啦~</strong>  </p>
<p>注：APNG增加的acTL、fcTL、fdAT类型在第三版的PNG规范中已经收录，也就是说都能在这份官方文档中查到。</p>
<h3 id="关键数据块"><a href="#关键数据块" class="headerlink" title="关键数据块"></a>关键数据块</h3><p>有些类型的数据块基本上必须存在于一张PNG图像中，称为<strong>Critical Chunk</strong>。</p>
<p>以下为四种Critical Chunk，其中只有PLTE是可选的，<strong>其它都必须出现，而且必须以以下顺序出现</strong></p>
<p><img lazyload="" src="/images/loading.svg" data-src="/2025/09/17/%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E8%A7%A3%E6%9E%90/PixPin_2025-09-22_15-16-02.png" alt="PixPin_2025-09-22_15-16-02"></p>
<h4 id="开头与结尾-IHDR-IEND"><a href="#开头与结尾-IHDR-IEND" class="headerlink" title="开头与结尾 IHDR-IEND"></a>开头与结尾 IHDR-IEND</h4><p>类型一个是<strong>IHDR</strong>，一个是<strong>IEND</strong>， 没必要记16进制码，直接记字母就行。</p>
<p><strong>IHDR</strong>是非常特殊的块，它和<strong>IEND</strong>一起框定了一串数据的范围。可以理解为，一段有效的数据，比如一帧，它会是很多数据块，解析的时候遇到<strong>IHDR</strong>就知道这段数据开始了，遇到<strong>IEND</strong>意味着这段数据结束了。 前者<strong>必须是第一个数据块</strong>，而后者<strong>必须是最后一个数据块</strong>。</p>
<p>甚至还有人发现可以在IEND后面藏数据而不影响图像显示<sup id="fnref:2_0"><a href="javascript:void(0);" rel="footnote" onclick="footnote_rememberSource('2', '2_0'); footnote_jumpToAnchor('fn:2')">[2]</a></sup>。</p>
<p>其中<strong>IEND</strong>就是一个结束标志，其长度域为0，之后不再提，但<strong>IHDR</strong>类型对应的数据块还存储了一些有用的信息，图像的宽高属性就存储在这里，下一节详细解析。</p>
<h4 id="IHDR-Image-header"><a href="#IHDR-Image-header" class="headerlink" title="IHDR Image header"></a>IHDR Image header</h4><p><strong>IHDR</strong>总长度是固定的13bytes，内部数据排布如下:</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><strong>Width</strong></td>
<td>4 bytes</td>
</tr>
<tr>
<td><strong>Height</strong></td>
<td>4 bytes</td>
</tr>
<tr>
<td><strong>Bit depth</strong></td>
<td>1 byte</td>
</tr>
<tr>
<td><strong>Color type</strong></td>
<td>1 byte</td>
</tr>
<tr>
<td><strong>Compression method</strong></td>
<td>1 byte</td>
</tr>
<tr>
<td><strong>Filter method</strong></td>
<td>1 byte</td>
</tr>
<tr>
<td><strong>Interlace method</strong></td>
<td>1 byte</td>
</tr>
</tbody></table>
<p>一般用户只需要关注前4个属性即可，分别代表<strong>图像的宽</strong>、<strong>图像的高</strong>、<strong>图像位深</strong>、<strong>颜色类型</strong></p>
<p>宽高以像素为单位；位深指的是<strong>每个颜色通道的位深，而不是整个像素的位深</strong>，即记录的是每个颜色通道使用多少比特进行编码。</p>
<p>颜色类型(注意颜色类型和位深只有关系的)：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="/2025/09/17/%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E8%A7%A3%E6%9E%90/PixPin_2025-09-22_15-27-19.png" alt="PixPin_2025-09-22_15-27-19"></p>
<p>即便官方文档暗示了这些属性是顺序排列的，但严谨地讲它似乎并没有<strong>明确指出</strong>排列顺序。不过基于“<strong>协议本身是稳定的，市面上流传的PNG图像的这几个属性的排列顺序是稳定的</strong>”的假设，可以找一张PNG图像拆开来验证这一点——结论：<strong>至少前四个属性是按顺序存储的</strong>。</p>
<p><img lazyload="" src="/images/loading.svg" data-src="/2025/09/17/%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E8%A7%A3%E6%9E%90/PixPin_2025-09-17_22-47-35.png" alt="PixPin_2025-09-17_22-47-35"></p>
<p>这里宽是<strong>0x500</strong>，对应十进制<strong>1280</strong>，长为<strong>0x8E3</strong>，对应十进制<strong>2275</strong>，这正好就是在下这张测试图像分辨率中的宽高，通过测试。</p>
<p><strong>0x08</strong>对应颜色位深8，<strong>0x02</strong>对应真彩色图像，RGB三色通道各使用8位编码，所以每个像素使用<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="10.308ex" height="1.717ex" role="img" focusable="false" viewBox="0 -677 4556 759"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path></g><g data-mml-node="mo" transform="translate(722.2,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mn" transform="translate(1722.4,0)"><path data-c="38" d="M70 417T70 494T124 618T248 666Q319 666 374 624T429 515Q429 485 418 459T392 417T361 389T335 371T324 363L338 354Q352 344 366 334T382 323Q457 264 457 174Q457 95 399 37T249 -22Q159 -22 101 29T43 155Q43 263 172 335L154 348Q133 361 127 368Q70 417 70 494ZM286 386L292 390Q298 394 301 396T311 403T323 413T334 425T345 438T355 454T364 471T369 491T371 513Q371 556 342 586T275 624Q268 625 242 625Q201 625 165 599T128 534Q128 511 141 492T167 463T217 431Q224 426 228 424L286 386ZM250 21Q308 21 350 55T392 137Q392 154 387 169T375 194T353 216T330 234T301 253T274 270Q260 279 244 289T218 306L210 311Q204 311 181 294T133 239T107 157Q107 98 150 60T250 21Z"></path></g><g data-mml-node="mo" transform="translate(2500.2,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(3556,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z" transform="translate(500,0)"></path></g></g></g></svg></mjx-container>位编码，对应图像位深度24，通过测试。</p>
<p><img lazyload="" src="/images/loading.svg" data-src="/2025/09/17/%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E8%A7%A3%E6%9E%90/PixPin_2025-09-17_22-52-30.png" alt="PixPin_2025-09-17_22-52-30"></p>
<ul>
<li>注: <strong>数据大端对齐</strong>，即高字节对应低地址</li>
</ul>
<h4 id="PLTE"><a href="#PLTE" class="headerlink" title="PLTE"></a>PLTE</h4><p>Palette，调色盘。</p>
<p>含1-256个entries，每个entry三个字节，每个字节分别对应红绿蓝。</p>
<p>似乎主要是用于压缩等用途的元信息，也不是必须的数据块，非PNG图像的最小组成部分之一，这里跳过。</p>
<h4 id="IDAT"><a href="#IDAT" class="headerlink" title="IDAT"></a>IDAT</h4><p><strong>Image Data</strong>， 图像真实的数据</p>
<p>注：不是将每个像素的RGB存储的原始数据，而<strong>是压缩算法的输出结果</strong></p>
<p>必须的数据块类型就上述四种，其它感兴趣可以去文档中了解。</p>
<h3 id="如何获得图像尺寸"><a href="#如何获得图像尺寸" class="headerlink" title="如何获得图像尺寸"></a>如何获得图像尺寸</h3><p>基于上述观察，实际上只需要越过PNG的文件署名，直接进入IHDR头中的固定偏移位置取出对应数据即可。</p>
<hr>
<h2 id="JPEG"><a href="#JPEG" class="headerlink" title="JPEG"></a>JPEG</h2><p>特别注意，JPEG和PNG不同，并非一个单一独立的规范，而存在很多不同的标准——不同的文件格式。<strong>这里参考T.81标准</strong><sup id="fnref:3_0"><a href="javascript:void(0);" rel="footnote" onclick="footnote_rememberSource('3', '3_0'); footnote_jumpToAnchor('fn:3')">[3]</a></sup>, 又称<strong>ISO/IEC 10918-1 标准</strong>,  算是JPEG压缩技术最权威最官方的一个技术标准了，能够解释现在流行的绝大部分JPEG文件的格式，如JFIF和Exif。文献很长，这里只关注JPEG的数据结构，基本可以从31页的<strong>Compressed data formats</strong>章节开始看。</p>
<p>由于JPEG格式与PNG不同，相对而言要复杂许多，所以这里不做非常详细地解读，搞清楚宏观的结构并理解如何获取图像尺寸就结束了。 <del class="mask">(因为真实的数据反正也要过压缩算法，费劲搞清楚了感觉一般也用不到)</del>。</p>
<h3 id="宏观设计"><a href="#宏观设计" class="headerlink" title="宏观设计"></a>宏观设计</h3><p>从最高层次看，JPEG文件有点像之前的PNG，但不完全一样。PNG由一个署名打头，后面跟着很多数据块(chunk)，而JPEG则直接由一系列的<strong>段(Segment)<strong>组成。而段又分</strong>标记段(Marker Segment)<strong>和</strong>熵编码数据段(Entropy-coded data segments)</strong>，前者作为标记和引导，存储着大量元信息，而后者则是图像本体在压缩后的结果载体。</p>
<p>虽然文档中提到了“参数”，但在下认为这里提到的参数不过是“段”的组成部分，不需要单独拎出来理解。</p>
<blockquote>
<p>Structurally, the compressed data formats consist of <strong>an ordered collection of parameters, markers, and entropy-coded data segments</strong>. Parameters and markers in turn are often organized into marker segments. Because all of these constituent parts are represented with byte-aligned codes, each compressed data format consists of an ordered sequence of 8-bit bytes. For each byte, a most significant bit (MSB) and a least significant bit (LSB) are defined</p>
</blockquote>
<p>可以想象我们是一个流式的数据解析器，我们顺序地读入JPEG数据，会读到一个个<strong>段</strong>，在熵编码数据段之前会读到<strong>标记段(Marker Segement)</strong>，其由一个<strong>标记Marker</strong>和若干跟随的<strong>参数</strong>(长度可为0)组成。我们可以利用这些像“路标”一样的<strong>标记Marker</strong>，识别后续内容，快速跳过不需要的信息，也可以从跟随其的参数中提取出一些需要的元信息。</p>
<p>整体上来看，JPEG文件的数据流就是<strong>很多的标记段和穿插的‘几个’熵编码数据段</strong></p>
<ul>
<li>对于Baseline JPEG，图像数据是一个完整的连续的熵编码数据段 (相当于一次扫描)</li>
<li>但是对于Progressive JPEG，每次扫描不断填充细节和色彩精度，熵编码数据段就不是连续的</li>
<li>不过从下图看，无论是基线还是渐进JPEG，都可以插入重启标记RST, 以增加容错性。</li>
</ul>
<p><img lazyload="" src="/images/loading.svg" data-src="/2025/09/17/%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E8%A7%A3%E6%9E%90/PixPin_2025-09-19_21-38-38.png" alt="PixPin_2025-09-19_21-38-38"></p>
<p>我们不关注具体被压缩后的数据长什么样，所以对我们来说现在最重要的就是如何辨识<strong>标记(Marker)</strong></p>
<h3 id="标记Marker"><a href="#标记Marker" class="headerlink" title="标记Marker"></a>标记Marker</h3><p><strong>总结，找到字节0xFF，并且后面不是0x00</strong>, 就找到了Marker，0xFF后面跟的字节就决定了类型。</p>
<h4 id="Marker的格式"><a href="#Marker的格式" class="headerlink" title="Marker的格式"></a>Marker的格式</h4><p><strong>长两个字节</strong></p>
<ul>
<li><p>第一个字节：一定是 <strong>0xFF</strong>。 这个特别的值应该就是专门保留出来标识Marker的</p>
</li>
<li><p>第二个字节：</p>
<ul>
<li><p>特殊情况</p>
<ul>
<li>不能是<strong>0x00</strong>： 为了防止在数据段出现<strong>0xFF</strong>被误认为Marker，所以数据中的<strong>0xFF</strong>后面都会跟上<strong>0x00</strong>， 表明这是数据。</li>
<li>如果是<strong>0xFF</strong>:  被称为填充字节(<strong>fill bytes</strong>), 并不代表Marker的类型，仅做填充。可能是出于数据对齐的考量而设计，总之解析到<strong>0xFF</strong>的话，就继续往下看一位</li>
</ul>
</li>
<li><p>正常情况，第二个字节标识了Marker的类型，标识了接下来的数据是什么类型的数据，具体匹配关系可以参见下表</p>
<blockquote>
<p><img lazyload="" src="/images/loading.svg" data-src="/2025/09/17/%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E8%A7%A3%E6%9E%90/PixPin_2025-09-18_23-12-43.png" alt="PixPin_2025-09-18_23-12-43"></p>
</blockquote>
</li>
</ul>
</li>
</ul>
<p>特别说明：文档中提到的，<strong>Marker中存储的两字节长度参数，特指该Marker段的长度(不包含开头的‘两’个字节，但是包含记录长度的两个字节)</strong>，并不代表后面可能跟着的数据段的长度。这个参数用于快速跳过该Marker段达到下一个Marker段。</p>
<h3 id="具体数据构造"><a href="#具体数据构造" class="headerlink" title="具体数据构造"></a>具体数据构造</h3><p>让我们结合例子逐步剖析。这里使用<a class="link" target="_blank" rel="noopener" href="https://www.onlinehexeditor.com/">onlinehexeditor<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>作为十六进制查看器，因为它还能提供对jpeg结构的部分信息的解析与提取，有助于辅助我们构建认知模型。</p>
<p>注：建议将Marker表钉在屏幕的某个位置，方便确认Marker类型。</p>
<p>可以看到JPEG其实是一个多层级结构，把Frame视为主体，则两侧分别有SOI和EOI，这里我上传了一张jpeg图像作为示例</p>
<p><img lazyload="" src="/images/loading.svg" data-src="/2025/09/17/%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E8%A7%A3%E6%9E%90/PixPin_2025-09-19_22-12-40.png" alt="PixPin_2025-09-19_22-12-40"></p>
<p><img lazyload="" src="/images/loading.svg" data-src="/2025/09/17/%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E8%A7%A3%E6%9E%90/PixPin_2025-09-19_22-13-49.png" alt="PixPin_2025-09-19_22-13-49"></p>
<p>查表不难发现，开头的数据和结尾的数据恰恰就是SOI和EOI的Marker。然后这两个Maker没有长度，因为仅作标识作用，无内部信息需要存储。</p>
<p>然后我们进入真实的数据帧，重点要找的是帧头Frame Header, 但沿途的景色我们也顺便解析一下。</p>
<p><img lazyload="" src="/images/loading.svg" data-src="/2025/09/17/%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E8%A7%A3%E6%9E%90/PixPin_2025-09-19_22-19-51.png" alt="PixPin_2025-09-19_22-19-51"></p>
<p>APP<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="1.148ex" height="0.725ex" role="img" focusable="false" viewBox="0 -162.5 507.3 320.3"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"></g><g data-mml-node="mi" transform="translate(33,-150) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container> 是为应用程序预留的，可能会有很多，在这里会写入些应用程序想要写入的元数据。可能是用于进行控制——比如旋转，有可能就只是记录一些信息。比如这里看右侧转译结果，可以隐约看到JFIF的字眼，这说明该JPEG图像大概率是基于JFIF标准的。至于comment，则如其名。</p>
<p><strong>DQT</strong>代表定义量化表Define Quantization Table，这跟JPEG的压缩算法直接相关。大致理解的话，应该是在压缩过程中，具体可参考文档中的DCT算法，对于处理后得到的8 × 8 DCT coefficient array，去除以量化表中的64个值。这里注意到DQT段的长度并非0x0041(多出来的第一个字节是量化精度)而是0x0084, 应该是因为这里存了两个量化表，0x0082的长度，再算上长度数据本身的两个字节，就计算得到了0x0084.</p>
<p>再往后就到了我们能够解析出图像尺寸的最重要的Frame header了！(不知道为什么文档35页对应部分只特别提了所有非差分类型的SOF，但私以为Frame Header的结构应该都是一样的，即图中所示SOF<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="1.148ex" height="0.725ex" role="img" focusable="false" viewBox="0 -162.5 507.3 320.3"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"></g><g data-mml-node="mi" transform="translate(33,-150) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container>, 是一种一般表示)</p>
<p><img lazyload="" src="/images/loading.svg" data-src="/2025/09/17/%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E8%A7%A3%E6%9E%90/PixPin_2025-09-19_22-44-48.png" alt="PixPin_2025-09-19_22-44-48"></p>
<p>仍然是Marker Segment，但是是SOF类的。所以关键在于遍历到SOF的Marker然后停下。</p>
<p>第一个参数Lf其实就是这个Segment的长度，和之前都一样，占两个字节。第二个参数P表示样本精度，即每个采样点sample需要多少位来存储，即每个color的位深。</p>
<p>噔噔噔，然后终于，我们遇到了Y和X参数，看看它们的官方解释</p>
<blockquote>
<p><strong>Y</strong>: Number of lines – Specifies the maximum number of lines in the source image. This shall be equal to the number of lines in the component with the maximum number of vertical samples (see A.1.1). Value 0 indicates that the number of lines shall be defined by the DNL marker and parameters at the end of the first scan (see B.2.5)</p>
<p><strong>X</strong>: Number of samples per line – Specifies the maximum number of samples per line in the source image. This shall be equal to the number of samples per line in the component with the maximum number of horizontal samples (see A.1.1)</p>
</blockquote>
<p>一个是行数，一个是每行的采样点数量，这很显然就是我们一直在寻觅的宽高了。浅看一下这几个参数的位宽。</p>
<p><img lazyload="" src="/images/loading.svg" data-src="/2025/09/17/%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E8%A7%A3%E6%9E%90/PixPin_2025-09-19_22-50-54.png" alt="PixPin_2025-09-19_22-50-54"></p>
<p>让我们结合刚才那个例子来观察一下，</p>
<p><img lazyload="" src="/images/loading.svg" data-src="/2025/09/17/%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E8%A7%A3%E6%9E%90/PixPin_2025-09-19_22-52-12.png" alt="PixPin_2025-09-19_22-52-12"></p>
<p>可以看到P是8，单色为8，三色乘3便是24，而高宽分别为十六机制0x0438, 十进制数1080。这恰好符合文件属性。</p>
<p><img lazyload="" src="/images/loading.svg" data-src="/2025/09/17/%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E8%A7%A3%E6%9E%90/PixPin_2025-09-19_23-00-48.png" alt="PixPin_2025-09-19_23-00-48"></p>
<p>注：这里可能会有一点让人感到困惑的地方。P是8，表示这里的sample是一个color sample，而X是1080，又说明一行的元素个数和一行的像素个数相同。其实这不矛盾，想象多个矩阵阵列即可理解，不同颜色的矩阵可以独立存储(即不是[R1, G1, B1], [R2, G2, B2], [R3, G3, B3] … 这样存的)。</p>
<p>刚才那张图高宽相同，可能有些迷惑，这里再换个例子看一遍，这是另一张位深24，分辨率4096x2160的JPEG图像。</p>
<p><img lazyload="" src="/images/loading.svg" data-src="/2025/09/17/%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E8%A7%A3%E6%9E%90/PixPin_2025-09-19_23-06-03.png" alt="PixPin_2025-09-19_23-06-03"></p>
<p>可以看到，高0x0870, 即十进制2160，宽0x1000，即十进制4096, 完美符合预期，顺序也可以得到映证。</p>
<p>为了直观地感受到这张图是<strong>扁</strong>的，而非<strong>长</strong>的，这里附上分辨率4096x2160的样例图:</p>
<img lazyload="" src="/images/loading.svg" data-src="./图片格式解析/78c1cc8cd9b45122c4404a21d24ea20b1652522653936.jpeg" alt="78c1cc8cd9b45122c4404a21d24ea20b1652522653936" style="zoom: 25%;">

<p>眼见的话其实会发现刚才两个案例在<strong>ffc0</strong>的Marker后面都出现了<strong>ffc4</strong>， 这个对应的是Marker <strong>DHT</strong>， 即Define Huffman table(s), 哈夫曼表。这里涉及到压缩算法，不展开讲——<del class="mask">因为它似乎有很多版本</del>, 至少除了Huffman coding还有arithmetic coding。	</p>
<p>不管怎么说，到底我们就能得到绝大多数JEPG图像尺寸了(基于T.81标准的)。</p>
<h2 id="Get-Image-Size"><a href="#Get-Image-Size" class="headerlink" title="Get Image Size"></a>Get Image Size</h2><p>基于以上观察，这里给出获取PNG图像和大部分JPEG图像(包括JFIF和EXIF)宽高的js代码。仅供参考:</p>
<div class="code-container" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@file</span> imageSize.js</span></span><br><span class="line"><span class="comment"> * A image dimension parser.</span></span><br><span class="line"><span class="comment"> * Supports PNG and JPEG formats.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * A function to get dimensions of PNG and JPEG images from a Buffer.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> {<span class="type">Buffer</span>} buffer The image data buffer.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> {<span class="type">{width: number, height: number, type: 'png' | 'jpeg'</span>} | null}</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">imageSize</span>(<span class="params">buffer</span>) {</span><br><span class="line">  <span class="keyword">try</span> {</span><br><span class="line">    <span class="comment">//PNG</span></span><br><span class="line">    <span class="keyword">const</span> pngResult = <span class="title function_">parsePNG</span>(buffer);</span><br><span class="line">    <span class="keyword">if</span> (pngResult) {</span><br><span class="line">      <span class="keyword">return</span> pngResult;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//JPEG</span></span><br><span class="line">    <span class="keyword">const</span> jpegResult = <span class="title function_">parseJPEG</span>(buffer);</span><br><span class="line">    <span class="keyword">if</span>(jpegResult){</span><br><span class="line">      <span class="keyword">return</span> jpegResult;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">'Unsupported image format'</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>; </span><br><span class="line">  } <span class="keyword">catch</span> (e) {</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(e);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// --- Constants for PNG Parsing ---</span></span><br><span class="line"><span class="comment">// reference: https://www.w3.org/TR/png-3/#5DataRep</span></span><br><span class="line"><span class="comment">// All PNG files start with this 8-byte signature.</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PNG_SIGNATURE</span> = <span class="title class_">Buffer</span>.<span class="title function_">from</span>([<span class="number">0x89</span>, <span class="number">0x50</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x0D</span>, <span class="number">0x0A</span>, <span class="number">0x1A</span>, <span class="number">0x0A</span>]);</span><br><span class="line"><span class="comment">// The IHDR chunk type identifier in ASCII.</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">IHDR_CHUNK_TYPE</span> = <span class="title class_">Buffer</span>.<span class="title function_">from</span>(<span class="string">'IHDR'</span>);</span><br><span class="line"><span class="comment">// The IHDR chunk's data section must be 13 bytes long.</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">EXPECTED_IHDR_LENGTH</span> = <span class="number">13</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Parses a Buffer to extract dimensions of a PNG image.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> {<span class="type">Buffer</span>} buffer The buffer containing the image data.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> {<span class="type">{width: number, height: number, type: 'png'</span>} | null} Dimensions object or null if not a valid PNG with IHDR chunk.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">parsePNG</span>(<span class="params">buffer</span>) {</span><br><span class="line">  <span class="keyword">try</span> {</span><br><span class="line">    <span class="comment">// A valid PNG with dimensions requires at least 33 bytes for signature and IHDR info.</span></span><br><span class="line">    <span class="comment">// 8 (signature) + 4 (length) + 4 (type) + 13 + 4(CRC) = 33 bytes</span></span><br><span class="line">    <span class="keyword">if</span> (buffer.<span class="property">length</span> &lt; <span class="number">33</span>) {</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Verify the PNG file signature.</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable constant_">PNG_SIGNATURE</span>.<span class="title function_">equals</span>(buffer.<span class="title function_">subarray</span>(<span class="number">0</span>, <span class="number">8</span>))) {</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// --- IHDR Chunk Verification  ---</span></span><br><span class="line">    <span class="comment">// length must be 13. readUInt32BE reads a 4-byte, Big-Endian integer.</span></span><br><span class="line">    <span class="keyword">const</span> ihdrLength = buffer.<span class="title function_">readUInt32BE</span>(<span class="number">8</span>);</span><br><span class="line">    <span class="keyword">if</span> (ihdrLength !== <span class="variable constant_">EXPECTED_IHDR_LENGTH</span>) {</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// type must be "IHDR".</span></span><br><span class="line">    <span class="keyword">const</span> chunkType = buffer.<span class="title function_">subarray</span>(<span class="number">12</span>, <span class="number">16</span>);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable constant_">IHDR_CHUNK_TYPE</span>.<span class="title function_">equals</span>(chunkType)) {</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// --- extract the dimensions ---</span></span><br><span class="line">    <span class="comment">// width: 4 bytes</span></span><br><span class="line">    <span class="keyword">const</span> width = buffer.<span class="title function_">readUInt32BE</span>(<span class="number">16</span>);</span><br><span class="line">    <span class="comment">// height: 4 bytes</span></span><br><span class="line">    <span class="keyword">const</span> height = buffer.<span class="title function_">readUInt32BE</span>(<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> { width, height, <span class="attr">type</span>: <span class="string">'png'</span> };</span><br><span class="line"></span><br><span class="line">  } <span class="keyword">catch</span> (e) {</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(e);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// --- Constants for JPEG Parsing ---</span></span><br><span class="line"><span class="comment">// reference: ITU T.81, Annex B  https://www.w3.org/Graphics/JPEG/itu-t81.pdf</span></span><br><span class="line"><span class="comment">// Start of Image marker</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">JPG_SOI</span> = <span class="number">0xFFD8</span>;</span><br><span class="line"><span class="comment">// End of Image marker</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">JPG_EOI</span> = <span class="number">0xFFD9</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Start of Frame markers </span></span><br><span class="line"><span class="comment">//non-differential, Huffman coding</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">JPG_SOF0</span>  = <span class="number">0xFFC0</span>; <span class="comment">// Baseline DCT</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">JPG_SOF1</span>  = <span class="number">0xFFC1</span>; <span class="comment">// Extended sequential DCT</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">JPG_SOF2</span>  = <span class="number">0xFFC2</span>; <span class="comment">// Progressive DCT</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">JPG_SOF3</span>  = <span class="number">0xFFC3</span>; <span class="comment">// Lossless (sequential)</span></span><br><span class="line"><span class="comment">//differential, Huffman coding</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">JPG_SOF5</span>  = <span class="number">0xFFC5</span>; <span class="comment">// sequential DCT</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">JPG_SOF6</span>  = <span class="number">0xFFC6</span>; <span class="comment">// progressive DCT</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">JPG_SOF7</span>  = <span class="number">0xFFC7</span>; <span class="comment">// lossless (sequential)</span></span><br><span class="line"><span class="comment">//non-differential, arithmetic coding</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">JPG_SOF9</span>  = <span class="number">0xFFC9</span>; <span class="comment">// Extended sequential DCT</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">JPG_SOF10</span> = <span class="number">0xFFCA</span>; <span class="comment">// Progressive DCT</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">JPG_SOF11</span> = <span class="number">0xFFCB</span>; <span class="comment">// Lossless (sequential)</span></span><br><span class="line"><span class="comment">//differential, arithmetic coding</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">JPG_SOF13</span> = <span class="number">0xFFCD</span>; <span class="comment">// sequential DCT</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">JPG_SOF14</span> = <span class="number">0xFFCE</span>; <span class="comment">// progressive DCT</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">JPG_SOF15</span> = <span class="number">0xFFCF</span>; <span class="comment">// lossless (sequential)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">SOF_MARKERS</span> = [</span><br><span class="line">  <span class="variable constant_">JPG_SOF0</span>, <span class="variable constant_">JPG_SOF1</span>, <span class="variable constant_">JPG_SOF2</span>, <span class="variable constant_">JPG_SOF3</span>,</span><br><span class="line">  <span class="variable constant_">JPG_SOF5</span>, <span class="variable constant_">JPG_SOF6</span>, <span class="variable constant_">JPG_SOF7</span>,</span><br><span class="line">  <span class="variable constant_">JPG_SOF9</span>, <span class="variable constant_">JPG_SOF10</span>, <span class="variable constant_">JPG_SOF11</span>,</span><br><span class="line">  <span class="variable constant_">JPG_SOF13</span>, <span class="variable constant_">JPG_SOF14</span>, <span class="variable constant_">JPG_SOF15</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Parses a Buffer to extract dimensions of a JPEG image.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> {<span class="type">Buffer</span>} buffer The buffer containing the image data.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> {<span class="type">{width: number, height: number, type: 'jpeg'</span>} | null}</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">parseJPEG</span>(<span class="params">buffer</span>){</span><br><span class="line">  <span class="keyword">try</span>{</span><br><span class="line">    <span class="comment">//Start with SOI</span></span><br><span class="line">    <span class="keyword">if</span>(buffer.<span class="title function_">readUInt16BE</span>(<span class="number">0</span>) !== <span class="variable constant_">JPG_SOI</span>){</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> offset = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">let</span> marker = buffer.<span class="title function_">readUInt16BE</span>(offset);</span><br><span class="line">    <span class="keyword">while</span>(!<span class="variable constant_">SOF_MARKERS</span>.<span class="title function_">includes</span>(marker)){</span><br><span class="line">      <span class="comment">//if not the SOF marker, skip to the next marker; note: RST_m will not occur before frame header, so we do not check for</span></span><br><span class="line">      length = buffer.<span class="title function_">readUInt16BE</span>(offset+<span class="number">2</span>);</span><br><span class="line">      offset += length + <span class="number">2</span>;</span><br><span class="line">      marker = buffer.<span class="title function_">readUInt16BE</span>(offset);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//For frameheader: 2 for marker, 2 for length, 1 for precision, 2 for height, 2 for width</span></span><br><span class="line">    <span class="keyword">return</span> { <span class="attr">height</span>: buffer.<span class="title function_">readUInt16BE</span>(offset+<span class="number">5</span>), <span class="attr">width</span>: buffer.<span class="title function_">readUInt16BE</span>(offset+<span class="number">7</span>), <span class="attr">type</span>: <span class="string">'jpeg'</span> };</span><br><span class="line">  }<span class="keyword">catch</span>(e){</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(e);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = {</span><br><span class="line">  imageSize,</span><br><span class="line">  parsePNG, </span><br><span class="line">  parseJPEG,</span><br><span class="line">};</span><br></pre></td></tr></table></figure></div>













<p><br><br><br></p>
<section class="footnotes"><ol class="footnotes-list"><li id="fn:1">W3C. <a class="link" target="_blank" rel="noopener" href="https://www.w3.org/TR/png-3/#5DataRep">Portable Network Graphics (PNG) Specification (Third Edition)<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>. W3C, 2025-06-25<a href="javascript:void(0);" onclick="footnote_returnToSource('1')"> ↩</a></li><li id="fn:2"><a class="link" target="_blank" rel="noopener" href="https://www.cnblogs.com/senior-engineer">maxiongying<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>. <a class="link" target="_blank" rel="noopener" href="https://www.cnblogs.com/senior-engineer/p/9548347.html">PNG文件格式详解 <i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>. 博客园, 2018-08-25<a href="javascript:void(0);" onclick="footnote_returnToSource('2')"> ↩</a></li><li id="fn:3">CCITT (The International Telegraph and Telephone Consultative Committee) / ITU (International Telecommunication Union). <a class="link" target="_blank" rel="noopener" href="https://www.w3.org/Graphics/JPEG/itu-t81.pdf">Recommendation T.81: Information Technology - Digital Compression and Coding of Continuous-tone Still Images - Requirements and Guidelines<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>. ITU (International Telecommunication Union), 1992-9-18<a href="javascript:void(0);" onclick="footnote_returnToSource('3')"> ↩</a></li><li id="fn:4">. <a class="link" target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/APNG">APNG<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>. wikipedia, 2025-9-10<a href="javascript:void(0);" onclick="footnote_returnToSource('4')"> ↩</a></li></ol></section>
		</div>

		
		<div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8">
			<div class="article-copyright-info-container">
    <ul>
        <li><strong>标题:</strong> 手撕主流图像(PNG/JPEG)：从理解文件数据结构到图像尺寸解析的实战</li>
        <li><strong>作者:</strong> Prometheus0017</li>
        <li><strong>创建于
                :</strong> 2025-09-17 16:40:04</li>
        
            <li>
                <strong>更新于
                    :</strong> 2025-09-22 16:25:48
            </li>
        
        <li>
            <strong>链接:</strong> https://blog-seeles-secret-garden.vercel.app/2025/09/17/图片格式解析/
        </li>
        <li>
            <strong>
                版权声明:
            </strong>
            

            
                本文章采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a> 进行许可。
            
        </li>
    </ul>
</div>

		</div>
		

		
		<ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden">
			
			<li class="tag-item mx-0.5">
				<a href="/tags/PNG/">#PNG</a>&nbsp;
			</li>
			
			<li class="tag-item mx-0.5">
				<a href="/tags/JPEG/">#JPEG</a>&nbsp;
			</li>
			
			<li class="tag-item mx-0.5">
				<a href="/tags/image/">#image</a>&nbsp;
			</li>
			
			<li class="tag-item mx-0.5">
				<a href="/tags/protocol/">#protocol</a>&nbsp;
			</li>
			
			<li class="tag-item mx-0.5">
				<a href="/tags/learning/">#learning</a>&nbsp;
			</li>
			
		</ul>
		

		
  <div class="recommended-article px-2 sm:px-6 md:px-8">
   <div class="recommended-desktop">
    <div class="recommended-article-header text-xl md:text-3xl font-bold mt-10">
     <i aria-hidden="true"></i><span>推荐阅读</span>
    </div>
    <div class="recommended-article-group"><a class="recommended-article-item" href="/2025/09/02/%E6%AC%A2%E8%BF%8E%E6%9D%A5%E5%88%B0AIGC%E7%9A%84%E9%AD%94%E6%B3%95%E4%B8%96%E7%95%8C/" title="欢迎来到AIGC的魔法世界" rel="bookmark">
  <img src="https://pub-a1cb67b2f5c34421bbd8c98bcf68643b.r2.dev/gallery/魔法模因_20250720.png" alt="欢迎来到AIGC的魔法世界" class="!max-w-none">
  <span class="title">欢迎来到AIGC的魔法世界</span>
</a><a class="recommended-article-item" href="/2025/08/25/@mikolov2013EfficientEstimationWord/" title="重读经典：Word2Vec如何通过“简化”撬动了整个NLP世界？" rel="bookmark">
  <img src="https://pub-a1cb67b2f5c34421bbd8c98bcf68643b.r2.dev/gallery/昔涟-十指相扣.png" alt="重读经典：Word2Vec如何通过“简化”撬动了整个NLP世界？" class="!max-w-none">
  <span class="title">重读经典：Word2Vec如何通过“简化”撬动了整个NLP世界？</span>
</a><a class="recommended-article-item" href="/2025/09/16/MinimalRepresentingOfcuboid/" title="为什么长方体上的三个点不能唯一确定一个长方体?" rel="bookmark">
  <img src="https://pub-a1cb67b2f5c34421bbd8c98bcf68643b.r2.dev/gallery/2025/09/16/美.jpeg" alt="为什么长方体上的三个点不能唯一确定一个长方体?" class="!max-w-none">
  <span class="title">为什么长方体上的三个点不能唯一确定一个长方体?</span>
</a></div>
   </div>
   <div class="recommended-mobile">
   <div class="recommended-article-header text-xl md:text-3xl font-bold mt-10">
     <i aria-hidden="true"></i><span>推荐阅读</span>
   </div>
   <div class="recommended-article-group"><a class="recommended-article-item" href="/2025/09/02/%E6%AC%A2%E8%BF%8E%E6%9D%A5%E5%88%B0AIGC%E7%9A%84%E9%AD%94%E6%B3%95%E4%B8%96%E7%95%8C/" title="欢迎来到AIGC的魔法世界" rel="bookmark">
  <img src="https://pub-a1cb67b2f5c34421bbd8c98bcf68643b.r2.dev/gallery/魔法模因_20250720.png" alt="欢迎来到AIGC的魔法世界" class="!max-w-none">
  <span class="title">欢迎来到AIGC的魔法世界</span>
</a><a class="recommended-article-item" href="/2025/08/25/@mikolov2013EfficientEstimationWord/" title="重读经典：Word2Vec如何通过“简化”撬动了整个NLP世界？" rel="bookmark">
  <img src="https://pub-a1cb67b2f5c34421bbd8c98bcf68643b.r2.dev/gallery/昔涟-十指相扣.png" alt="重读经典：Word2Vec如何通过“简化”撬动了整个NLP世界？" class="!max-w-none">
  <span class="title">重读经典：Word2Vec如何通过“简化”撬动了整个NLP世界？</span>
</a></div>
   </div>
  </div>

		
		<div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
			
			
			<div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="next" rel="next" href="/2025/09/16/MinimalRepresentingOfcuboid/">
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item truncate max-w-48">为什么长方体上的三个点不能唯一确定一个长方体?</span>
						<span class="post-nav-item">下一篇</span>
					</span>
					<span class="right arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-right"></i>
					</span>
				</a>
			</div>
			
		</div>
		


		
		<div class="comment-container px-2 sm:px-6 md:px-8 pb-8">
			<div class="comments-container mt-10 w-full ">
    <div id="comment-anchor" class="w-full h-2.5"></div>
    <div class="comment-area-title w-full my-1.5 md:my-2.5 text-xl md:text-3xl font-bold">
        评论
    </div>
    

        
            
    <div id="giscus-container"></div>
    <script data-swup-reload-script defer>
        async function loadGiscus() {
            const giscusConfig = {
                'src': 'https://giscus.app/client.js',
                'data-repo': 'ElysiaFollower/ElysiaFollower.github.io',
                'data-repo-id': 'R_kgDOOlwzaQ',
                'data-category': 'Announcements',
                'data-category-id': 'DIC_kwDOOlwzac4Ct0-D',
                'data-mapping': 'pathname',
                'data-strict': '0',
                'data-reactions-enabled': '1',
                'data-emit-metadata': '1',
                'data-theme': 'preferred_color_scheme',
                'data-lang': 'zh-CN',
                'data-input-position': 'bottom',
                'data-loading': 'lazy',
                'crossorigin': 'anonymous',
                'async': true
            }
            const giscusScript = document.createElement('script');
            for (const key in giscusConfig) {
                giscusScript.setAttribute(key, giscusConfig[key]);
            }
            document.getElementById('giscus-container').appendChild(giscusScript);
        }
        if ('true') {
            let loadGiscusTimeout = setTimeout(() => {
                loadGiscus();
                clearTimeout(loadGiscusTimeout);
            }, 1000);
        } else {
            document.addEventListener('DOMContentLoaded', loadGiscus);
        }
    </script>


        
        
    
</div>

		</div>
		
	</div>

	
	<div class="toc-content-container">
		<div class="post-toc-wrap">
	<div class="post-toc">
		<div class="toc-title">目录</div>
		<div class="page-title">手撕主流图像(PNG/JPEG)：从理解文件数据结构到图像尺寸解析的实战</div>
		<ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#PNG"><span class="nav-text">PNG</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%BD%B2%E5%90%8D%E5%9F%9F-PNG-signature"><span class="nav-text">文件署名域(PNG signature)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%9D%97"><span class="nav-text">数据块</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E9%94%AE%E6%95%B0%E6%8D%AE%E5%9D%97"><span class="nav-text">关键数据块</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%80%E5%A4%B4%E4%B8%8E%E7%BB%93%E5%B0%BE-IHDR-IEND"><span class="nav-text">开头与结尾 IHDR-IEND</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#IHDR-Image-header"><span class="nav-text">IHDR Image header</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PLTE"><span class="nav-text">PLTE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#IDAT"><span class="nav-text">IDAT</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E8%8E%B7%E5%BE%97%E5%9B%BE%E5%83%8F%E5%B0%BA%E5%AF%B8"><span class="nav-text">如何获得图像尺寸</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JPEG"><span class="nav-text">JPEG</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%8F%E8%A7%82%E8%AE%BE%E8%AE%A1"><span class="nav-text">宏观设计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%87%E8%AE%B0Marker"><span class="nav-text">标记Marker</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Marker%E7%9A%84%E6%A0%BC%E5%BC%8F"><span class="nav-text">Marker的格式</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B7%E4%BD%93%E6%95%B0%E6%8D%AE%E6%9E%84%E9%80%A0"><span class="nav-text">具体数据构造</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Get-Image-Size"><span class="nav-text">Get Image Size</span></a></li></ol>

	</div>
</div>
	</div>
	
</div>
			</div>

			
		</div>

		<div class="main-content-footer">
			<footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
            <div class="customize-info my-1">从二次元到二进制 (From ACG to Binary)</div>
        
        <div class="text-center">
            &copy;
            
              <span>2025</span>
              -
            
            2025&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">Prometheus0017</a>
            
                
                <p class="post-count space-x-0.5">
                    <span>
                        共撰写了 8 篇文章
                    </span>
                    
                        <span>
                            共 21.7k 字
                        </span>
                    
                </p>
            
        </div>
        
            <script data-swup-reload-script src="https://cn.vercount.one/js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                    <span id="busuanzi_container_site_uv" class="lg:!block">
                        <span class="text-sm">访问人数</span>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="lg:!block">
                        <span class="text-sm">总访问量</span>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">由 <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a> 驱动</span>
            <span class="text-sm lg:block">主题&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.8.5</a></span>
        </div>
        
        
            <div>
                博客已运行 <span class="odometer" id="runtime_days" ></span> 天 <span class="odometer" id="runtime_hours"></span> 小时 <span class="odometer" id="runtime_minutes"></span> 分钟 <span class="odometer" id="runtime_seconds"></span> 秒
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
            
                
        
                
        
        
    </div>  
</footer>
		</div>
	</div>

	
	<div class="post-tools">
		<div class="post-tools-container">
	<ul class="article-tools-list">
		<!-- TOC aside toggle -->
		
		<li class="right-bottom-tools page-aside-toggle">
			<i class="fa-regular fa-outdent"></i>
		</li>
		

		<!-- go comment -->
		
		<li class="go-comment">
			<i class="fa-regular fa-comments"></i>
		</li>
		
	</ul>
</div>
	</div>
	

	<div class="right-side-tools-container">
		<div class="side-tools-container">
	<ul class="hidden-tools-list">
		<li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-plus"></i>
		</li>

		<li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-minus"></i>
		</li>

		<li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
			<i class="fa-regular fa-moon"></i>
		</li>

		<!-- rss -->
		
		<li class="right-bottom-tools rss flex justify-center items-center">
			<a class="flex justify-center items-center" href="/atom.xml" target="_blank">
				<i class="fa-regular fa-rss"></i>
			</a>
		</li>
		

		

		<li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
			<i class="fa-regular fa-arrow-down"></i>
		</li>
	</ul>

	<ul class="visible-tools-list">
		<li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
			<i class="fa-regular fa-cog fa-spin"></i>
		</li>
		
		<li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
			<i class="arrow-up fas fa-arrow-up"></i>
			<span class="percent"></span>
		</li>
		
		
	</ul>
</div>
	</div>

	<div class="image-viewer-container">
	<img src="">
</div>

	
	<div class="search-pop-overlay">
	<div class="popup search-popup">
		<div class="search-header">
			<span class="search-input-field-pre">
				<i class="fa-solid fa-keyboard"></i>
			</span>
			<div class="search-input-container">
				<input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="站内搜索您需要的内容..." spellcheck="false" type="search" class="search-input">
			</div>
			<span class="popup-btn-close">
				<i class="fa-solid fa-times"></i>
			</span>
		</div>
		<div id="search-result">
			<div id="no-result">
				<i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
			</div>
		</div>
	</div>
</div>
	

</main>



<script src="/js/build/libs/Swup.min.js"></script>

<script src="/js/build/libs/SwupSlideTheme.min.js"></script>

<script src="/js/build/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/build/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/build/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/build/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>




	
<script src="/js/build/tools/imageViewer.js" type="module"></script>

<script src="/js/build/utils.js" type="module"></script>

<script src="/js/build/main.js" type="module"></script>

<script src="/js/build/layouts/navbarShrink.js" type="module"></script>

<script src="/js/build/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/build/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/build/layouts/categoryList.js" type="module"></script>



    
<script src="/js/build/tools/localSearch.js" type="module"></script>




    
<script src="/js/build/tools/codeBlock.js" type="module"></script>




    
<script src="/js/build/layouts/lazyload.js" type="module"></script>




    
<script src="/js/build/tools/runtime.js"></script>

    
<script src="/js/build/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/build/libs/Typed.min.js"></script>

  
<script src="/js/build/plugins/typed.js" type="module"></script>




    
        
<script src="/js/build/libs/mermaid.min.js"></script>

    
    
<script src="/js/build/plugins/mermaid.js"></script>




    
<script src="/js/build/libs/minimasonry.min.js"></script>

    
<script src="/js/build/libs/lazysizes.min.js"></script>

    
<script src="/js/build/plugins/masonry.js" type="module"></script>







    
<script src="/js/build/tools/tocToggle.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/layouts/toc.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/plugins/tabs.js" type="module" data-swup-reload-script=""></script>




<script src="/js/build/libs/moment-with-locales.min.js" data-swup-reload-script=""></script>


<script src="/js/build/layouts/essays.js" type="module" data-swup-reload-script=""></script>



    
<script src="/js/build/libs/pangu.min.js"></script>

<script src="/js/build/plugins/pangu.js"></script>







<script src="/js/build/custom/footnote.js" data-swup-reload-script=""></script>

	
	<div id="aplayer"></div>

<script src="/js/build/libs/APlayer.min.js"></script>


<script src="/js/build/plugins/aplayer.js"></script>


	
</body>

</html>